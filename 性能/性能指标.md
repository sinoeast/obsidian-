# 业务指标
![image.png](https://gitee.com/sinoeast/imgs/raw/master/20230210164827.png)

## 吞吐量指标（吞吐量比较低-系统每秒处理的请求数量有限）

> 单位时间内，系统处理的请求数量。【以秒为单位】 超过一定请求后吞吐量会达到瓶颈不变,判断这个吞吐量是否符合要求

细分：tps-transaction-事务-多个操作【涉及数据库数据变更操作】（淘宝--下单-事务操作-tps)
细分：qps-Query--查询-不涉及数据变动的操作（淘宝-查看商品-数据查询-qps)

## 响应时间(发请求到收到请求响应，耗时)

> 响应时间RT ResponseTime-关系到用户体验 135原则，5秒以上需要优化

## 成功率
> 在高并发状态下，程序是否会出现处理失败的情况。
10000/s请求，失败了100，成功率99%
有些场景：对于成功率要求很高【用户体验】

# 硬件指标
## CPU资源利用率
![image.png](https://gitee.com/sinoeast/imgs/raw/master/20230213144748.png)

当CPU使用率高时，确定是用户CPU高，还是系统CPU高  
Ø 如果是用户CPU高，说明某个软件程序的CPU资源占用率高，需要定位代码程序运行的效率（`top`命令查询占用资源利用率最高进程，根据进程pid号查占用资源利用率最高线程，如果是Java应用，就可以用jstack看出此线程正在执行的堆栈，看资源消耗在哪个方法上，查看源代码就知道问题所在）  
Ø 如果是系统CPU高，同步观察是否是其他资源（磁盘IO、内存、网络等）不足

## 内存利用率
`vmstat`
内存高：内存的问题主要看某个进程占用的内存是否非常大以及是否有大量的swap(虚拟内存交换)

## 磁盘IO
`iostat -x 1 1`
磁盘IO高：通过减少日志输出、异步或换速度快的硬盘来降低繁忙率

## 网络IO
`sar -n DEV 1 2`
网络IO高：网络IO主要考虑传输内容大小，不能超过硬件网络传输的最大值70%，可以通过压缩减少内容大小、在本地设置缓存以及分多次传输等操作提高网络IO性能。

# 软件指标
## JDBC连接池
jdbc连接池：增加连接数，要搞清楚连接未释放原因

## JVM（GC/full GC/堆大小）

## 慢查询

## 锁等待/死锁

## 缓存命中率

## 会话

## 进程
线程池不够：增加线程，要搞清楚为什么线层阻塞

# 聚合报告
![image.png](https://gitee.com/sinoeast/imgs/raw/master/20230210165412.png)

*面试过程中-如何向面试官证明自己有实战经验？*
你做性能测试碰到过什么难题？
高并发会出现的错误
Jmeter发起请求报错：java.net.BindException:address already in use:connect
原因：网络请求发起的时候：服务器需要一个固定端口接收数据-~客户端向服务器发起请求，需要占用一个客户端的端口
处理：单台机器能够发起的请求数量是有限的-*Jmeter集群压测*


# 性能分析
我们的系统最多能处理多少并发？（取决于吞吐量指标）
**绝对并发**：同一时间有多少请求给服务器处理【秒->毫秒--还有更小的单位】
比如实时聊天室，同时在线人数【并发】--网络长连接
抢票->同一时间  [[Jmeter#并发（同时抢票，登录。。）]]
**相对并发**：一段时间内，服务器需要处理的数量【常用单位1秒】
web应用基本都是http请求-【短链接概念：请求/响应->结束】以秒为单位
*能处理的并发量约等于=最大吞吐量*

# 如何知道系统最大吞吐量[系统瓶颈所在]
![image.png](https://gitee.com/sinoeast/imgs/raw/master/20230210171449.png)
吞吐量会*随着并发量(线程增加)而增加*，
吞吐量达到一定值之后，不再增加，*趋于平稳*
> 不断增加并发量，直至吞吐量不再增加【**性能拐点**】

